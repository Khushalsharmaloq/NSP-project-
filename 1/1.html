<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Library Books Manager</title>
  <script src="/_sdk/data_sdk.js"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
    body {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      height: 100%;
      overflow-x: hidden;
    }

    html {
      height: 100%;
    }

    * {
      box-sizing: border-box;
    }

    .container {
      min-height: 100%;
      padding: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }

    .navigation {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border-radius: 12px;
      padding: 15px;
      margin-bottom: 20px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .nav-tabs {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: center;
    }

    .nav-tab {
      padding: 12px 20px;
      border: none;
      background: transparent;
      color: #6b7280;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s;
      font-size: 0.95em;
    }

    .nav-tab:hover {
      background: rgba(102, 126, 234, 0.1);
      color: #667eea;
    }

    .nav-tab.active {
      background: #667eea;
      color: white;
      box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
    }

    .page {
      display: none;
    }

    .page.active {
      display: block;
    }

    .dashboard-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .dashboard-card {
      background: white;
      border-radius: 12px;
      padding: 25px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .dashboard-card h3 {
      margin: 0 0 15px 0;
      color: #1f2937;
      font-size: 1.3em;
    }

    .chart-placeholder {
      height: 200px;
      background: linear-gradient(45deg, #f3f4f6, #e5e7eb);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #6b7280;
      font-size: 1.1em;
      margin-bottom: 15px;
    }

    .metric-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 0;
      border-bottom: 1px solid #f3f4f6;
    }

    .metric-row:last-child {
      border-bottom: none;
    }

    .metric-label {
      color: #6b7280;
      font-weight: 600;
    }

    .metric-value {
      color: #1f2937;
      font-weight: 700;
      font-size: 1.1em;
    }

    .book-detail-page {
      background: white;
      border-radius: 16px;
      padding: 40px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      max-width: 800px;
      margin: 0 auto;
    }

    .book-header {
      display: flex;
      gap: 30px;
      margin-bottom: 30px;
      align-items: flex-start;
    }

    .book-cover {
      width: 200px;
      height: 300px;
      background: linear-gradient(135deg, #667eea, #764ba2);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 3em;
      flex-shrink: 0;
    }

    .book-info {
      flex: 1;
    }

    .book-info h1 {
      margin: 0 0 10px 0;
      color: #1f2937;
      font-size: 2.5em;
      line-height: 1.2;
    }

    .book-info .author {
      font-size: 1.3em;
      color: #6b7280;
      margin-bottom: 20px;
    }

    .info-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .info-item {
      background: #f9fafb;
      padding: 15px;
      border-radius: 8px;
    }

    .info-item-label {
      font-size: 0.9em;
      color: #6b7280;
      font-weight: 600;
      margin-bottom: 5px;
    }

    .info-item-value {
      font-size: 1.1em;
      color: #1f2937;
      font-weight: 600;
    }

    .reports-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 25px;
    }

    .report-card {
      background: white;
      border-radius: 12px;
      padding: 25px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .report-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .report-title {
      font-size: 1.3em;
      font-weight: 700;
      color: #1f2937;
      margin: 0;
    }

    .report-period {
      font-size: 0.9em;
      color: #6b7280;
      background: #f3f4f6;
      padding: 4px 12px;
      border-radius: 20px;
    }

    .search-filters {
      background: white;
      border-radius: 12px;
      padding: 25px;
      margin-bottom: 25px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .filter-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 20px;
    }

    .settings-section {
      background: white;
      border-radius: 12px;
      padding: 25px;
      margin-bottom: 20px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .settings-section h3 {
      margin: 0 0 20px 0;
      color: #1f2937;
      font-size: 1.3em;
      padding-bottom: 10px;
      border-bottom: 2px solid #f3f4f6;
    }

    .setting-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 0;
      border-bottom: 1px solid #f3f4f6;
    }

    .setting-item:last-child {
      border-bottom: none;
    }

    .setting-info h4 {
      margin: 0 0 5px 0;
      color: #1f2937;
      font-size: 1.1em;
    }

    .setting-info p {
      margin: 0;
      color: #6b7280;
      font-size: 0.95em;
    }

    .toggle-switch {
      position: relative;
      width: 50px;
      height: 24px;
      background: #d1d5db;
      border-radius: 12px;
      cursor: pointer;
      transition: background 0.3s;
    }

    .toggle-switch.active {
      background: #667eea;
    }

    .toggle-switch::after {
      content: '';
      position: absolute;
      top: 2px;
      left: 2px;
      width: 20px;
      height: 20px;
      background: white;
      border-radius: 50%;
      transition: transform 0.3s;
    }

    .toggle-switch.active::after {
      transform: translateX(26px);
    }

    .header {
      text-align: center;
      margin-bottom: 30px;
      color: white;
    }

    .header h1 {
      margin: 0 0 10px 0;
      font-size: 2.5em;
      font-weight: 700;
    }

    .header p {
      margin: 0;
      font-size: 1.1em;
      opacity: 0.95;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 30px;
    }

    .stat-card {
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      text-align: center;
    }

    .stat-number {
      font-size: 2.5em;
      font-weight: 700;
      color: #667eea;
      margin: 0;
    }

    .stat-label {
      font-size: 0.9em;
      color: #666;
      margin: 5px 0 0 0;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .main-content {
      background: white;
      border-radius: 16px;
      padding: 30px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
    }

    .form-section {
      margin-bottom: 30px;
      padding-bottom: 30px;
      border-bottom: 2px solid #f0f0f0;
    }

    .form-section h2 {
      margin: 0 0 20px 0;
      color: #333;
      font-size: 1.5em;
    }

    .form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 15px;
      margin-bottom: 20px;
    }

    .form-group {
      display: flex;
      flex-direction: column;
    }

    .form-group label {
      margin-bottom: 8px;
      font-weight: 600;
      color: #555;
      font-size: 0.9em;
    }

    .form-group input,
    .form-group select {
      padding: 12px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 1em;
      transition: border-color 0.3s;
    }

    .form-group input:focus,
    .form-group select:focus {
      outline: none;
      border-color: #667eea;
    }

    .btn {
      padding: 12px 30px;
      border: none;
      border-radius: 8px;
      font-size: 1em;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
    }

    .btn-primary {
      background: #667eea;
      color: white;
    }

    .btn-primary:hover {
      background: #5568d3;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
    }

    .btn-primary:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
    }

    .btn-danger {
      background: #ef4444;
      color: white;
      padding: 8px 16px;
      font-size: 0.9em;
    }

    .btn-danger:hover {
      background: #dc2626;
    }

    .btn-success {
      background: #10b981;
      color: white;
      padding: 8px 16px;
      font-size: 0.9em;
      margin-right: 8px;
    }

    .btn-success:hover {
      background: #059669;
    }

    .filter-section {
      display: flex;
      gap: 15px;
      margin-bottom: 20px;
      flex-wrap: wrap;
      align-items: center;
    }

    .filter-section select,
    .filter-section input {
      padding: 10px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 0.95em;
      flex: 1;
      min-width: 200px;
    }

    .books-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
    }

    .book-card {
      background: #f9fafb;
      border: 2px solid #e5e7eb;
      border-radius: 12px;
      padding: 20px;
      transition: all 0.3s;
    }

    .book-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
      border-color: #667eea;
    }

    .book-title {
      font-size: 1.3em;
      font-weight: 700;
      color: #1f2937;
      margin: 0 0 8px 0;
    }

    .book-author {
      font-size: 1em;
      color: #6b7280;
      margin: 0 0 12px 0;
    }

    .book-details {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-bottom: 15px;
    }

    .book-detail-item {
      display: flex;
      justify-content: space-between;
      font-size: 0.9em;
    }

    .detail-label {
      color: #6b7280;
      font-weight: 600;
    }

    .detail-value {
      color: #374151;
    }

    .status-badge {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 0.85em;
      font-weight: 600;
    }

    .status-available {
      background: #d1fae5;
      color: #065f46;
    }

    .status-borrowed {
      background: #fef3c7;
      color: #92400e;
    }

    .status-reserved {
      background: #dbeafe;
      color: #1e40af;
    }

    .book-actions {
      display: flex;
      gap: 8px;
      margin-top: 15px;
      padding-top: 15px;
      border-top: 1px solid #e5e7eb;
    }

    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: #6b7280;
    }

    .empty-state-icon {
      font-size: 4em;
      margin-bottom: 20px;
    }

    .empty-state h3 {
      margin: 0 0 10px 0;
      color: #374151;
      font-size: 1.5em;
    }

    .empty-state p {
      margin: 0;
      font-size: 1.1em;
    }

    .loading-spinner {
      display: inline-block;
      width: 16px;
      height: 16px;
      border: 3px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 0.8s linear infinite;
      margin-right: 8px;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .limit-warning {
      background: #fef3c7;
      border: 2px solid #fbbf24;
      color: #92400e;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      text-align: center;
      font-weight: 600;
    }

    @media (max-width: 768px) {
      .container {
        padding: 15px;
      }

      .header h1 {
        font-size: 1.8em;
      }

      .header p {
        font-size: 1em;
      }

      .main-content {
        padding: 20px;
      }

      .form-grid {
        grid-template-columns: 1fr;
      }

      .books-grid {
        grid-template-columns: 1fr;
      }

      .filter-section {
        flex-direction: column;
      }

      .filter-section select,
      .filter-section input {
        width: 100%;
        min-width: auto;
      }

      .stat-number {
        font-size: 2em;
      }
    }

    @media (max-width: 480px) {
      .header h1 {
        font-size: 1.5em;
      }

      .book-actions {
        flex-direction: column;
      }

      .btn {
        width: 100%;
      }
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="container">
   <div class="header">
    <h1 id="library-title">My Personal Library</h1>
    <p id="welcome-message">Welcome to your book collection</p>
   </div>
   <div class="navigation">
    <div class="nav-tabs"><button class="nav-tab active" onclick="showPage('dashboard')">üìä Dashboard</button> <button class="nav-tab" onclick="showPage('books')">üìö Books</button> <button class="nav-tab" onclick="showPage('book-detail')">üìñ Book Details</button> <button class="nav-tab" onclick="showPage('reports')">üìà Reports</button> <button class="nav-tab" onclick="showPage('search')">üîç Advanced Search</button> <button class="nav-tab" onclick="showPage('settings')">‚öôÔ∏è Settings</button> <button class="nav-tab" onclick="showPage('user-login')">üë§ User Login</button> <button class="nav-tab" onclick="showPage('admin-login')">üîê Admin Login</button>
    </div>
   </div><!-- Dashboard Page -->
   <div id="dashboard" class="page active">
    <div class="stats-grid">
     <div class="stat-card">
      <p class="stat-number" id="total-books">0</p>
      <p class="stat-label">Total Books</p>
     </div>
     <div class="stat-card">
      <p class="stat-number" id="available-books">0</p>
      <p class="stat-label">Available</p>
     </div>
     <div class="stat-card">
      <p class="stat-number" id="borrowed-books">0</p>
      <p class="stat-label">Borrowed</p>
     </div>
     <div class="stat-card">
      <p class="stat-number" id="reserved-books">0</p>
      <p class="stat-label">Reserved</p>
     </div>
    </div>
    <div class="dashboard-grid">
     <div class="dashboard-card">
      <h3>üìà Monthly Activity</h3>
      <div class="chart-placeholder">
       üìä Books Added This Month
      </div>
      <div class="metric-row"><span class="metric-label">Books Added</span> <span class="metric-value">12</span>
      </div>
      <div class="metric-row"><span class="metric-label">Books Borrowed</span> <span class="metric-value">8</span>
      </div>
      <div class="metric-row"><span class="metric-label">Books Returned</span> <span class="metric-value">5</span>
      </div>
     </div>
     <div class="dashboard-card">
      <h3>üìö Popular Genres</h3>
      <div class="chart-placeholder">
       üìä Genre Distribution
      </div>
      <div class="metric-row"><span class="metric-label">Fiction</span> <span class="metric-value">35%</span>
      </div>
      <div class="metric-row"><span class="metric-label">Non-Fiction</span> <span class="metric-value">28%</span>
      </div>
      <div class="metric-row"><span class="metric-label">Science Fiction</span> <span class="metric-value">22%</span>
      </div>
     </div>
     <div class="dashboard-card">
      <h3>‚è∞ Recent Activity</h3>
      <div style="padding: 15px 0;">
       <div class="metric-row"><span class="metric-label">üìñ "The Great Gatsby" borrowed</span> <span class="metric-value">2h ago</span>
       </div>
       <div class="metric-row"><span class="metric-label">üìö "1984" returned</span> <span class="metric-value">5h ago</span>
       </div>
       <div class="metric-row"><span class="metric-label">‚ûï "Dune" added to library</span> <span class="metric-value">1d ago</span>
       </div>
      </div>
     </div>
     <div class="dashboard-card">
      <h3>üéØ Quick Actions</h3>
      <div style="display: flex; flex-direction: column; gap: 10px; padding: 15px 0;"><button class="btn btn-primary" onclick="showPage('books')">Add New Book</button> <button class="btn btn-primary" onclick="showPage('search')">Search Books</button> <button class="btn btn-primary" onclick="showPage('reports')">View Reports</button>
      </div>
     </div>
    </div>
   </div><!-- Books Page -->
   <div id="books" class="page">
    <div class="main-content">
     <div class="form-section">
      <h2>Add New Book</h2>
      <div id="limit-warning" class="limit-warning" style="display: none;">
       Maximum limit of 999 books reached. Please delete some books first.
      </div>
      <form id="add-book-form">
       <div class="form-grid">
        <div class="form-group"><label for="book-title">Book Title</label> <input type="text" id="book-title" required placeholder="Enter book title">
        </div>
        <div class="form-group"><label for="book-author">Author</label> <input type="text" id="book-author" required placeholder="Enter author name">
        </div>
        <div class="form-group"><label for="book-isbn">ISBN</label> <input type="text" id="book-isbn" placeholder="Enter ISBN (optional)">
        </div>
        <div class="form-group"><label for="book-genre">Genre</label> <select id="book-genre" required> <option value="">Select genre</option> <option value="Fiction">Fiction</option> <option value="Non-Fiction">Non-Fiction</option> <option value="Science Fiction">Science Fiction</option> <option value="Mystery">Mystery</option> <option value="Romance">Romance</option> <option value="Biography">Biography</option> <option value="History">History</option> <option value="Self-Help">Self-Help</option> <option value="Other">Other</option> </select>
        </div>
        <div class="form-group"><label for="book-status">Status</label> <select id="book-status" required> <option value="Available">Available</option> <option value="Borrowed">Borrowed</option> <option value="Reserved">Reserved</option> </select>
        </div>
       </div><button type="submit" class="btn btn-primary" id="add-btn"> Add Book to Library </button>
      </form>
     </div>
     <div>
      <h2>Book Collection</h2>
      <div class="filter-section"><input type="text" id="search-input" placeholder="üîç Search by title or author..."> <select id="genre-filter"> <option value="">All Genres</option> <option value="Fiction">Fiction</option> <option value="Non-Fiction">Non-Fiction</option> <option value="Science Fiction">Science Fiction</option> <option value="Mystery">Mystery</option> <option value="Romance">Romance</option> <option value="Biography">Biography</option> <option value="History">History</option> <option value="Self-Help">Self-Help</option> <option value="Other">Other</option> </select> <select id="status-filter"> <option value="">All Status</option> <option value="Available">Available</option> <option value="Borrowed">Borrowed</option> <option value="Reserved">Reserved</option> </select>
      </div>
      <div id="books-container" class="books-grid"></div>
     </div>
    </div>
   </div><!-- Book Detail Page -->
   <div id="book-detail" class="page">
    <div class="book-detail-page">
     <div class="book-header">
      <div class="book-cover">
       üìö
      </div>
      <div class="book-info">
       <h1>The Great Gatsby</h1>
       <p class="author">by F. Scott Fitzgerald</p>
       <div class="status-badge status-available">
        Available
       </div>
      </div>
     </div>
     <div class="info-grid">
      <div class="info-item">
       <div class="info-item-label">
        ISBN
       </div>
       <div class="info-item-value">
        978-0-7432-7356-5
       </div>
      </div>
      <div class="info-item">
       <div class="info-item-label">
        Genre
       </div>
       <div class="info-item-value">
        Fiction
       </div>
      </div>
      <div class="info-item">
       <div class="info-item-label">
        Publication Year
       </div>
       <div class="info-item-value">
        1925
       </div>
      </div>
      <div class="info-item">
       <div class="info-item-label">
        Pages
       </div>
       <div class="info-item-value">
        180
       </div>
      </div>
      <div class="info-item">
       <div class="info-item-label">
        Language
       </div>
       <div class="info-item-value">
        English
       </div>
      </div>
      <div class="info-item">
       <div class="info-item-label">
        Added Date
       </div>
       <div class="info-item-value">
        Jan 15, 2024
       </div>
      </div>
     </div>
     <div style="margin-top: 30px;">
      <h3>Description</h3>
      <p style="line-height: 1.6; color: #6b7280; margin-bottom: 30px;">The Great Gatsby is a 1925 novel by American writer F. Scott Fitzgerald. Set in the Jazz Age on prosperous Long Island and in New York City, the novel tells the story of Jay Gatsby and his pursuit of the American Dream.</p>
     </div>
     <div style="display: flex; gap: 15px; flex-wrap: wrap;"><button class="btn btn-primary">Borrow Book</button> <button class="btn btn-success">Reserve Book</button> <button class="btn btn-danger">Edit Details</button>
     </div>
    </div>
   </div><!-- Reports Page -->
   <div id="reports" class="page">
    <div class="reports-grid">
     <div class="report-card">
      <div class="report-header">
       <h3 class="report-title">üìä Collection Overview</h3><span class="report-period">This Month</span>
      </div>
      <div class="chart-placeholder">
       üìà Collection Growth Chart
      </div>
      <div class="metric-row"><span class="metric-label">Total Books</span> <span class="metric-value">1,247</span>
      </div>
      <div class="metric-row"><span class="metric-label">New Additions</span> <span class="metric-value">23</span>
      </div>
      <div class="metric-row"><span class="metric-label">Books Removed</span> <span class="metric-value">3</span>
      </div>
     </div>
     <div class="report-card">
      <div class="report-header">
       <h3 class="report-title">üìö Borrowing Activity</h3><span class="report-period">Last 30 Days</span>
      </div>
      <div class="chart-placeholder">
       üìä Borrowing Trends
      </div>
      <div class="metric-row"><span class="metric-label">Books Borrowed</span> <span class="metric-value">156</span>
      </div>
      <div class="metric-row"><span class="metric-label">Books Returned</span> <span class="metric-value">142</span>
      </div>
      <div class="metric-row"><span class="metric-label">Overdue Books</span> <span class="metric-value">8</span>
      </div>
     </div>
     <div class="report-card">
      <div class="report-header">
       <h3 class="report-title">üèÜ Popular Books</h3><span class="report-period">All Time</span>
      </div>
      <div style="padding: 15px 0;">
       <div class="metric-row"><span class="metric-label">1. "To Kill a Mockingbird"</span> <span class="metric-value">47 borrows</span>
       </div>
       <div class="metric-row"><span class="metric-label">2. "1984"</span> <span class="metric-value">42 borrows</span>
       </div>
       <div class="metric-row"><span class="metric-label">3. "The Great Gatsby"</span> <span class="metric-value">38 borrows</span>
       </div>
       <div class="metric-row"><span class="metric-label">4. "Pride and Prejudice"</span> <span class="metric-value">35 borrows</span>
       </div>
      </div>
     </div>
     <div class="report-card">
      <div class="report-header">
       <h3 class="report-title">üìà Genre Statistics</h3><span class="report-period">Current Collection</span>
      </div>
      <div class="chart-placeholder">
       ü•ß Genre Distribution
      </div>
      <div class="metric-row"><span class="metric-label">Fiction</span> <span class="metric-value">435 books (35%)</span>
      </div>
      <div class="metric-row"><span class="metric-label">Non-Fiction</span> <span class="metric-value">349 books (28%)</span>
      </div>
      <div class="metric-row"><span class="metric-label">Science Fiction</span> <span class="metric-value">274 books (22%)</span>
      </div>
     </div>
    </div>
   </div><!-- Advanced Search Page -->
   <div id="search" class="page">
    <div class="search-filters">
     <h2>üîç Advanced Book Search</h2>
     <div class="filter-grid">
      <div class="form-group"><label>Search Term</label> <input type="text" placeholder="Title, author, or keyword...">
      </div>
      <div class="form-group"><label>Genre</label> <select> <option value="">All Genres</option> <option value="Fiction">Fiction</option> <option value="Non-Fiction">Non-Fiction</option> <option value="Science Fiction">Science Fiction</option> <option value="Mystery">Mystery</option> <option value="Romance">Romance</option> </select>
      </div>
      <div class="form-group"><label>Status</label> <select> <option value="">All Status</option> <option value="Available">Available</option> <option value="Borrowed">Borrowed</option> <option value="Reserved">Reserved</option> </select>
      </div>
      <div class="form-group"><label>Publication Year</label> <input type="number" placeholder="e.g., 2020">
      </div>
      <div class="form-group"><label>ISBN</label> <input type="text" placeholder="Enter ISBN">
      </div>
      <div class="form-group"><label>Date Added</label> <input type="date">
      </div>
     </div>
     <div style="display: flex; gap: 15px; margin-top: 20px;"><button class="btn btn-primary">üîç Search Books</button> <button class="btn" style="background: #6b7280; color: white;">Clear Filters</button>
     </div>
    </div>
    <div class="main-content">
     <h3>Search Results</h3>
     <div class="books-grid">
      <div class="book-card">
       <h3 class="book-title">Sample Search Result</h3>
       <p class="book-author">by Sample Author</p>
       <div class="book-details">
        <div class="book-detail-item"><span class="detail-label">Genre:</span> <span class="detail-value">Fiction</span>
        </div>
        <div class="book-detail-item"><span class="detail-label">Status:</span> <span class="status-badge status-available">Available</span>
        </div>
       </div>
       <div class="book-actions"><button class="btn btn-success">View Details</button> <button class="btn btn-primary">Borrow</button>
       </div>
      </div>
     </div>
    </div>
   </div><!-- Settings Page -->
   <div id="settings" class="page">
    <div class="settings-section">
     <h3>üîî Notification Settings</h3>
     <div class="setting-item">
      <div class="setting-info">
       <h4>Email Notifications</h4>
       <p>Receive email alerts for due dates and new books</p>
      </div>
      <div class="toggle-switch active" onclick="toggleSetting(this)"></div>
     </div>
     <div class="setting-item">
      <div class="setting-info">
       <h4>Overdue Reminders</h4>
       <p>Get reminded when books are overdue</p>
      </div>
      <div class="toggle-switch active" onclick="toggleSetting(this)"></div>
     </div>
     <div class="setting-item">
      <div class="setting-info">
       <h4>New Book Alerts</h4>
       <p>Notifications when new books are added</p>
      </div>
      <div class="toggle-switch" onclick="toggleSetting(this)"></div>
     </div>
    </div>
    <div class="settings-section">
     <h3>üìö Library Preferences</h3>
     <div class="setting-item">
      <div class="setting-info">
       <h4>Auto-Reserve Popular Books</h4>
       <p>Automatically reserve highly requested books</p>
      </div>
      <div class="toggle-switch" onclick="toggleSetting(this)"></div>
     </div>
     <div class="setting-item">
      <div class="setting-info">
       <h4>Extended Borrowing Period</h4>
       <p>Allow 30-day borrowing instead of 14 days</p>
      </div>
      <div class="toggle-switch active" onclick="toggleSetting(this)"></div>
     </div>
    </div>
    <div class="settings-section">
     <h3>üîí Privacy &amp; Security</h3>
     <div class="setting-item">
      <div class="setting-info">
       <h4>Public Reading List</h4>
       <p>Make your reading history visible to others</p>
      </div>
      <div class="toggle-switch" onclick="toggleSetting(this)"></div>
     </div>
     <div class="setting-item">
      <div class="setting-info">
       <h4>Data Export</h4>
       <p>Download your library data and reading history</p>
      </div><button class="btn btn-primary">Export Data</button>
     </div>
    </div>
   </div><!-- User Login Page -->
   <div id="user-login" class="page">
    <div class="main-content" style="max-width: 500px; margin: 0 auto;">
     <div style="text-align: center; margin-bottom: 30px;">
      <h2>üë§ User Login</h2>
      <p style="color: #6b7280;">Access your personal library account</p>
     </div>
     <form style="display: flex; flex-direction: column; gap: 20px;">
      <div class="form-group"><label>Email Address</label> <input type="email" placeholder="Enter your email" required>
      </div>
      <div class="form-group"><label>Password</label> <input type="password" placeholder="Enter your password" required>
      </div>
      <div style="display: flex; align-items: center; gap: 10px;"><input type="checkbox" id="remember-me"> <label for="remember-me" style="margin: 0; font-size: 0.95em;">Remember me</label>
      </div><button type="submit" class="btn btn-primary" style="width: 100%;"> Sign In to Library </button>
     </form>
     <div style="text-align: center; margin-top: 25px; padding-top: 25px; border-top: 1px solid #e5e7eb;">
      <p style="color: #6b7280; margin-bottom: 15px;">Don't have an account?</p><button class="btn" style="background: #10b981; color: white; width: 100%;"> Create New Account </button>
     </div>
     <div style="text-align: center; margin-top: 20px;"><a href="#" style="color: #667eea; text-decoration: none; font-size: 0.95em;"> Forgot your password? </a>
     </div>
    </div>
   </div><!-- Admin Login Page -->
   <div id="admin-login" class="page">
    <div class="main-content" style="max-width: 500px; margin: 0 auto;">
     <div style="text-align: center; margin-bottom: 30px;">
      <h2>üîê Administrator Login</h2>
      <p style="color: #6b7280;">Secure access to library management system</p>
      <div style="background: #fef3c7; border: 1px solid #fbbf24; color: #92400e; padding: 12px; border-radius: 8px; margin-top: 15px; font-size: 0.9em;">
       ‚ö†Ô∏è Admin access required for system management
      </div>
     </div>
     <form style="display: flex; flex-direction: column; gap: 20px;">
      <div class="form-group"><label>Administrator ID</label> <input type="text" placeholder="Enter admin ID" required>
      </div>
      <div class="form-group"><label>Admin Password</label> <input type="password" placeholder="Enter admin password" required>
      </div>
      <div class="form-group"><label>Security Code</label> <input type="text" placeholder="Enter 6-digit security code" maxlength="6" required>
      </div>
      <div style="display: flex; align-items: center; gap: 10px;"><input type="checkbox" id="secure-session" required> <label for="secure-session" style="margin: 0; font-size: 0.95em;">Enable secure session</label>
      </div><button type="submit" class="btn btn-primary" style="width: 100%; background: #dc2626;"> üîê Admin Sign In </button>
     </form>
     <div style="background: #f3f4f6; padding: 20px; border-radius: 8px; margin-top: 25px;">
      <h4 style="margin: 0 0 10px 0; color: #374151;">Admin Features:</h4>
      <ul style="margin: 0; padding-left: 20px; color: #6b7280; font-size: 0.95em;">
       <li>Manage all library books and users</li>
       <li>Generate detailed reports and analytics</li>
       <li>Configure system settings and permissions</li>
       <li>Monitor borrowing activity and overdue items</li>
       <li>Backup and restore library data</li>
      </ul>
     </div>
     <div style="text-align: center; margin-top: 20px;"><a href="#" style="color: #dc2626; text-decoration: none; font-size: 0.95em;"> Contact IT Support </a>
     </div>
    </div>
   </div>
  </div>
  <script>
    const defaultConfig = {
      library_title: "My Personal Library",
      welcome_message: "Welcome to your book collection",
      background_color: "#667eea",
      surface_color: "#ffffff",
      text_color: "#1f2937",
      primary_action_color: "#667eea",
      secondary_action_color: "#ef4444",
      font_family: "Inter",
      font_size: 16
    };

    let allBooks = [];
    let isLoading = false;

    const dataHandler = {
      onDataChanged(data) {
        allBooks = data;
        updateStats();
        renderBooks();
      }
    };

    async function initializeApp() {
      const initResult = await window.dataSdk.init(dataHandler);
      if (!initResult.isOk) {
        console.error("Failed to initialize data SDK");
      }
    }

    function updateStats() {
      const total = allBooks.length;
      const available = allBooks.filter(b => b.status === 'Available').length;
      const borrowed = allBooks.filter(b => b.status === 'Borrowed').length;
      const reserved = allBooks.filter(b => b.status === 'Reserved').length;

      document.getElementById('total-books').textContent = total;
      document.getElementById('available-books').textContent = available;
      document.getElementById('borrowed-books').textContent = borrowed;
      document.getElementById('reserved-books').textContent = reserved;

      const limitWarning = document.getElementById('limit-warning');
      const addBtn = document.getElementById('add-btn');
      
      if (total >= 999) {
        limitWarning.style.display = 'block';
        addBtn.disabled = true;
      } else {
        limitWarning.style.display = 'none';
        addBtn.disabled = false;
      }
    }

    function getFilteredBooks() {
      const searchTerm = document.getElementById('search-input').value.toLowerCase();
      const genreFilter = document.getElementById('genre-filter').value;
      const statusFilter = document.getElementById('status-filter').value;

      return allBooks.filter(book => {
        const matchesSearch = book.title.toLowerCase().includes(searchTerm) || 
                            book.author.toLowerCase().includes(searchTerm);
        const matchesGenre = !genreFilter || book.genre === genreFilter;
        const matchesStatus = !statusFilter || book.status === statusFilter;
        
        return matchesSearch && matchesGenre && matchesStatus;
      });
    }

    function renderBooks() {
      const container = document.getElementById('books-container');
      const filteredBooks = getFilteredBooks();

      if (filteredBooks.length === 0) {
        container.innerHTML = `
          <div class="empty-state">
            <div class="empty-state-icon">üìö</div>
            <h3>No books found</h3>
            <p>${allBooks.length === 0 ? 'Start building your library by adding your first book!' : 'Try adjusting your filters'}</p>
          </div>
        `;
        return;
      }

      container.innerHTML = filteredBooks.map(book => `
        <div class="book-card" data-book-id="${book.__backendId}">
          <h3 class="book-title">${escapeHtml(book.title)}</h3>
          <p class="book-author">by ${escapeHtml(book.author)}</p>
          <div class="book-details">
            ${book.isbn ? `
              <div class="book-detail-item">
                <span class="detail-label">ISBN:</span>
                <span class="detail-value">${escapeHtml(book.isbn)}</span>
              </div>
            ` : ''}
            <div class="book-detail-item">
              <span class="detail-label">Genre:</span>
              <span class="detail-value">${escapeHtml(book.genre)}</span>
            </div>
            <div class="book-detail-item">
              <span class="detail-label">Status:</span>
              <span class="status-badge status-${book.status.toLowerCase()}">${escapeHtml(book.status)}</span>
            </div>
            <div class="book-detail-item">
              <span class="detail-label">Added:</span>
              <span class="detail-value">${formatDate(book.added_date)}</span>
            </div>
          </div>
          <div class="book-actions">
            <button class="btn btn-success" onclick="changeStatus('${book.__backendId}')">
              Change Status
            </button>
            <button class="btn btn-danger" onclick="deleteBook('${book.__backendId}')">
              Delete
            </button>
          </div>
        </div>
      `).join('');
    }

    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    function formatDate(isoString) {
      const date = new Date(isoString);
      return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
    }

    async function changeStatus(bookId) {
      const book = allBooks.find(b => b.__backendId === bookId);
      if (!book) return;

      const statuses = ['Available', 'Borrowed', 'Reserved'];
      const currentIndex = statuses.indexOf(book.status);
      const nextStatus = statuses[(currentIndex + 1) % statuses.length];

      const updatedBook = { ...book, status: nextStatus };

      const card = document.querySelector(`[data-book-id="${bookId}"]`);
      const btn = card.querySelector('.btn-success');
      const originalText = btn.innerHTML;
      btn.innerHTML = '<span class="loading-spinner"></span>Updating...';
      btn.disabled = true;

      const result = await window.dataSdk.update(updatedBook);

      if (!result.isOk) {
        btn.innerHTML = originalText;
        btn.disabled = false;
        const errorMsg = document.createElement('div');
        errorMsg.style.cssText = 'background: #fee2e2; color: #991b1b; padding: 10px; border-radius: 8px; margin-top: 10px; text-align: center;';
        errorMsg.textContent = 'Failed to update status. Please try again.';
        card.appendChild(errorMsg);
        setTimeout(() => errorMsg.remove(), 3000);
      }
    }

    async function deleteBook(bookId) {
      const book = allBooks.find(b => b.__backendId === bookId);
      if (!book) return;

      const card = document.querySelector(`[data-book-id="${bookId}"]`);
      const deleteBtn = card.querySelector('.btn-danger');
      
      if (deleteBtn.textContent === 'Confirm Delete?') {
        const originalText = deleteBtn.innerHTML;
        deleteBtn.innerHTML = '<span class="loading-spinner"></span>Deleting...';
        deleteBtn.disabled = true;

        const result = await window.dataSdk.delete(book);

        if (!result.isOk) {
          deleteBtn.innerHTML = originalText;
          deleteBtn.disabled = false;
          const errorMsg = document.createElement('div');
          errorMsg.style.cssText = 'background: #fee2e2; color: #991b1b; padding: 10px; border-radius: 8px; margin-top: 10px; text-align: center;';
          errorMsg.textContent = 'Failed to delete book. Please try again.';
          card.appendChild(errorMsg);
          setTimeout(() => errorMsg.remove(), 3000);
        }
      } else {
        deleteBtn.textContent = 'Confirm Delete?';
        setTimeout(() => {
          if (deleteBtn) deleteBtn.textContent = 'Delete';
        }, 3000);
      }
    }

    document.getElementById('add-book-form').addEventListener('submit', async (e) => {
      e.preventDefault();

      if (allBooks.length >= 999) {
        return;
      }

      const title = document.getElementById('book-title').value;
      const author = document.getElementById('book-author').value;
      const isbn = document.getElementById('book-isbn').value;
      const genre = document.getElementById('book-genre').value;
      const status = document.getElementById('book-status').value;

      const newBook = {
        title,
        author,
        isbn,
        genre,
        status,
        added_date: new Date().toISOString()
      };

      const addBtn = document.getElementById('add-btn');
      const originalText = addBtn.innerHTML;
      addBtn.innerHTML = '<span class="loading-spinner"></span>Adding Book...';
      addBtn.disabled = true;

      const result = await window.dataSdk.create(newBook);

      if (result.isOk) {
        document.getElementById('add-book-form').reset();
      } else {
        const errorMsg = document.createElement('div');
        errorMsg.style.cssText = 'background: #fee2e2; color: #991b1b; padding: 15px; border-radius: 8px; margin-top: 15px; text-align: center;';
        errorMsg.textContent = 'Failed to add book. Please try again.';
        document.querySelector('.form-section').appendChild(errorMsg);
        setTimeout(() => errorMsg.remove(), 3000);
      }

      addBtn.innerHTML = originalText;
      addBtn.disabled = false;
    });

    document.getElementById('search-input').addEventListener('input', renderBooks);
    document.getElementById('genre-filter').addEventListener('change', renderBooks);
    document.getElementById('status-filter').addEventListener('change', renderBooks);

    function showPage(pageId) {
      // Hide all pages
      document.querySelectorAll('.page').forEach(page => {
        page.classList.remove('active');
      });
      
      // Remove active class from all nav tabs
      document.querySelectorAll('.nav-tab').forEach(tab => {
        tab.classList.remove('active');
      });
      
      // Show selected page
      document.getElementById(pageId).classList.add('active');
      
      // Add active class to clicked tab
      event.target.classList.add('active');
    }

    function toggleSetting(toggle) {
      toggle.classList.toggle('active');
    }

    async function onConfigChange(config) {
      const customFont = config.font_family || defaultConfig.font_family;
      const baseFontStack = '-apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif';
      const baseSize = config.font_size || defaultConfig.font_size;
      const backgroundColor = config.background_color || defaultConfig.background_color;
      const surfaceColor = config.surface_color || defaultConfig.surface_color;
      const textColor = config.text_color || defaultConfig.text_color;
      const primaryActionColor = config.primary_action_color || defaultConfig.primary_action_color;
      const secondaryActionColor = config.secondary_action_color || defaultConfig.secondary_action_color;

      document.body.style.fontFamily = `${customFont}, ${baseFontStack}`;
      document.querySelector('.container').style.background = `linear-gradient(135deg, ${backgroundColor} 0%, ${backgroundColor}dd 100%)`;
      
      document.querySelectorAll('.main-content, .stat-card').forEach(el => {
        el.style.background = surfaceColor;
      });

      document.querySelectorAll('.book-title, .header h1, h2, h3').forEach(el => {
        el.style.color = textColor;
        el.style.fontSize = `${baseSize * 1.5}px`;
      });

      document.querySelectorAll('.book-author, .detail-value, .stat-label, p').forEach(el => {
        el.style.color = textColor;
        el.style.fontSize = `${baseSize}px`;
      });

      document.querySelectorAll('.detail-label, label').forEach(el => {
        el.style.fontSize = `${baseSize * 0.9}px`;
      });

      document.querySelectorAll('.btn-primary').forEach(el => {
        el.style.background = primaryActionColor;
      });

      document.querySelectorAll('.btn-danger').forEach(el => {
        el.style.background = secondaryActionColor;
      });

      document.querySelectorAll('.stat-number').forEach(el => {
        el.style.color = primaryActionColor;
      });

      document.getElementById('library-title').textContent = config.library_title || defaultConfig.library_title;
      document.getElementById('welcome-message').textContent = config.welcome_message || defaultConfig.welcome_message;
    }

    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange,
        mapToCapabilities: (config) => ({
          recolorables: [
            {
              get: () => config.background_color || defaultConfig.background_color,
              set: (value) => {
                config.background_color = value;
                window.elementSdk.setConfig({ background_color: value });
              }
            },
            {
              get: () => config.surface_color || defaultConfig.surface_color,
              set: (value) => {
                config.surface_color = value;
                window.elementSdk.setConfig({ surface_color: value });
              }
            },
            {
              get: () => config.text_color || defaultConfig.text_color,
              set: (value) => {
                config.text_color = value;
                window.elementSdk.setConfig({ text_color: value });
              }
            },
            {
              get: () => config.primary_action_color || defaultConfig.primary_action_color,
              set: (value) => {
                config.primary_action_color = value;
                window.elementSdk.setConfig({ primary_action_color: value });
              }
            },
            {
              get: () => config.secondary_action_color || defaultConfig.secondary_action_color,
              set: (value) => {
                config.secondary_action_color = value;
                window.elementSdk.setConfig({ secondary_action_color: value });
              }
            }
          ],
          borderables: [],
          fontEditable: {
            get: () => config.font_family || defaultConfig.font_family,
            set: (value) => {
              config.font_family = value;
              window.elementSdk.setConfig({ font_family: value });
            }
          },
          fontSizeable: {
            get: () => config.font_size || defaultConfig.font_size,
            set: (value) => {
              config.font_size = value;
              window.elementSdk.setConfig({ font_size: value });
            }
          }
        }),
        mapToEditPanelValues: (config) => new Map([
          ["library_title", config.library_title || defaultConfig.library_title],
          ["welcome_message", config.welcome_message || defaultConfig.welcome_message]
        ])
      });
    }

    initializeApp();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'99a1d34da2e489f0',t:'MTc2MjQwMzExMC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>